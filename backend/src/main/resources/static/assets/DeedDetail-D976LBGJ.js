import{h as T,d as f,l as W,c as n,s as $,a as e,x as N,f as E,o as l,b as X,F as _,j as h,t as m,g as C,n as P,k as D,p as Q,y as Y,e as ee,z as k,i as y,w as K,u as te,r as se,B as R,C as ae,D as le,E as ne}from"./index-DFrjnd2F.js";import{_ as oe}from"./PreviewDocument.vue_vue_type_script_setup_true_lang-B3OHPqhj.js";const de=T({__name:"DeedNumber",props:{deed:{type:Object,required:!0}},emits:["saved"],setup(w,{emit:x}){const u=w,s=x,p=f(),c=f();W(()=>u==null?void 0:u.deed,v=>{v&&(c.value=v||null)},{immediate:!0});const d=async()=>{try{const v=await E.put(`/deeds/${u.deed.id}/number`,{number:p.value});s("saved",v.data)}catch(v){console.log("Gagal menyimpan nomor akta : ",v)}};return(v,a)=>(l(),n("div",null,[$(e("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>p.value=r),placeholder:"Nomor Akta",class:"w-full border p-1 mb-2 rounded"},null,512),[[N,p.value]]),e("button",{onClick:d,class:"bg-green-600 text-white px-4 py-2 rounded"}," Simpan ")]))}}),re={class:"p-2"},ue={class:"flex flex-wrap gap-3"},ie={class:"font-semibold"},pe={class:"text-sm"},me={class:"flex gap-2"},ce=["onClick"],ve=["onClick"],be=T({__name:"DeedUserDocument",props:{documents:{}},emits:["reupload"],setup(w,{emit:x}){const u="https://api.aplikasianda.com",s=x,p=f(""),c=a=>{s("reupload",a)},d=a=>{const r=`${u}/${a.name}`;p.value=r,console.log(" previewUrl ",p.value)},v=a=>{switch(a){case"APPROVED":return"text-green-600 font-semibold";case"REJECTED":return"text-red-600 font-semibold";case"PENDING":return"text-yellow-600 font-semibold";default:return"text-gray-600"}};return(a,r)=>(l(),n("div",re,[r[2]||(r[2]=e("h3",{class:"text-lg font-bold mb-4"},"Daftar Dokumen",-1)),e("div",ue,[(l(!0),n(_,null,h(a.documents,b=>(l(),n("div",{key:b.id,class:"w-full sm:w-auto flex-grow border border-gray-400 p-2 rounded-2xl"},[e("div",null,[e("p",ie,m(b.docType),1),e("p",pe,[r[1]||(r[1]=C(" Status: ")),e("span",{class:P(v(b.status))},m(b.status),3)])]),e("div",me,[e("button",{onClick:S=>d(b),class:"text-blue-600 underline"},"Lihat",8,ce),b.status==="REJECTED"?(l(),n("button",{key:0,onClick:S=>c(b),class:"bg-yellow-500 text-white text-sm px-2 py-1 rounded hover:bg-yellow-600"}," Unggah Ulang ",8,ve)):D("",!0)])]))),128))]),X(oe,{"preview-url":p.value,onClose:r[0]||(r[0]=b=>p.value="")},null,8,["preview-url"])]))}}),xe={class:"w-full"},ge=T({__name:"SetDeedOnProgress",props:{deed:{type:Object,required:!0}},emits:["saved"],setup(w,{emit:x}){const u=w,s=f();W(()=>u==null?void 0:u.deed,a=>{a&&(s.value=a||null)},{immediate:!0});const p=a=>{const r=Q[a.deedType]||[],S=((a==null?void 0:a.deedDocs)||[]).filter(g=>g.status!=="UPLOADED").map(g=>g.docType);return r.every(g=>S.includes(g))},c=x,d=async()=>{try{const a=await E.put(`/deeds/${u.deed.id}/status`,{status:"REJECTED",note:"Ada dokumen yang salah"},{withCredentials:!0});c("saved",a.data)}catch(a){alert(" terjadi error "+a)}},v=async()=>{try{const a=await E.put(`/deeds/${u.deed.id}/status`,{status:"IN_PROGRESS",note:"Sedang diproses"},{withCredentials:!0});c("saved",a.data)}catch{}};return(a,r)=>(l(),n("div",xe,[e("button",{onClick:d,class:"bg-red-600 text-white px-4 py-2 rounded mr-2"}," Reject "),p(w.deed)?(l(),n("button",{key:0,onClick:v,class:"bg-green-600 text-white px-4 py-2 rounded"}," Proses ")):D("",!0)]))}}),ye={class:"flex gap-3 items-center mb-4"},fe={class:"gap-8 flex bg-white px-6 py-4 rounded-lg"},ke={class:"w-2/3 border-e-2 border-gray-300"},we={key:0,class:"mb-6"},De={class:"grid grid-cols-[auto_auto_1fr] gap-y-3 gap-x-2"},Se={class:"px-2 py-1 bg-green-800 rounded-md max-w-sm text-white font-bold text-xs"},_e={key:1,class:"px-4 pt-4 pb-2 border border-1 border-gray-200 mr-3"},he={key:0},Ee={key:1,class:"flex flex-wrap items-center gap-3 mb-4"},Ce={key:2},Te={class:"flex flex-wrap items-center gap-3 mb-4"},Ae={key:3},Re={class:"flex flex-wrap items-center gap-3 mb-4"},$e={key:4},Ne={class:"pl-3 w-1/3"},Pe={class:"relative border-s border-gray-200 dark:border-gray-700"},Ue={class:"mb-1 text-lg font-semibold text-gray-900 dark:text-white"},Oe={class:"block mb-2 text-sm font-bold leading-none text-gray-700 dark:text-gray-300"},Ie={class:"text-base font-normal text-gray-500 dark:text-gray-400"},Me=T({__name:"DeedDetail",setup(w){const x=Y(),u=te(),s=f(null),p=f(""),c=f(""),d=["DRAFT","IN_PROGRESS","WAITING_SIGNATURE","COMPLETED","REJECTED"],v={DRAFT:"DRAFT",IN_PROGRESS:"SEDANG PROSES",WAITING_SIGNATURE:"MENUNGGU TANDA TANGAN",COMPLETED:"KOMPLIT",REJECTED:"DITOLAK"},a=i=>v[i]||i,r=f([]),b=async i=>{s.value=i},S=async i=>{s.value=i},g=async()=>{var t;const i=await E.get(`/deeds/${u.params.id}/status-history`);s.value=i.data,r.value=(t=i.data)==null?void 0:t.deedDocs},U=i=>{p.value=i},O=async()=>{let i=d.indexOf(s.value.deedStatus);i!==-1&&i<d.length-1?(i++,p.value=d[i]):console.warn("Attempted to advance status beyond defined steps or current status not found."),console.log("selected Status (after calculation): ",p.value),await E.put(`/deeds/${u.params.id}/status`,{status:p.value,note:c.value},{withCredentials:!0}),alert("Status berhasil diperbarui"),g(),c.value=""};return ee(g),(i,t)=>{var G,V,M,B,F,J,L,j,H,q,Z,z;const I=se("router-link");return l(),n("div",null,[e("div",ye,[t[6]||(t[6]=e("h2",{class:"text-2xl font-semibold w-10/12"},"Detail Akta",-1)),((G=s.value)==null?void 0:G.deedStatus)==="DRAFT"&&y(x).isUser?(l(),k(I,{key:0,to:{name:"EditAktaForm",params:y(u).params.id},class:"bg-blue-400 px-4 py-2 rounded-md text-white text-sm"},{default:K(()=>t[4]||(t[4]=[C(" Edit ")])),_:1,__:[4]},8,["to"])):D("",!0),y(x).isAdmin?(l(),k(I,{key:1,to:`/operator/deeds/${y(u).params.id}/review-documents`,class:"bg-green-500 px-4 py-2 rounded-md text-white text-sm"},{default:K(()=>t[5]||(t[5]=[C(" Verifikasi Dokumen ")])),_:1,__:[5]},8,["to"])):D("",!0)]),e("div",fe,[e("div",ke,[s.value?(l(),n("div",we,[e("div",De,[t[7]||(t[7]=e("p",{class:"font-semibold text-left"},"Nomor Akta",-1)),t[8]||(t[8]=e("p",null,":",-1)),e("p",null,m(s.value.number),1),t[9]||(t[9]=e("p",{class:"font-semibold text-left"},"Judul",-1)),t[10]||(t[10]=e("p",null,":",-1)),e("p",null,m(s.value.title),1),t[11]||(t[11]=e("p",{class:"font-semibold text-left"},"Jenis",-1)),t[12]||(t[12]=e("p",null,":",-1)),e("p",null,m(s.value.deedType),1),t[13]||(t[13]=e("p",{class:"font-semibold text-left"},"Deskripsi",-1)),t[14]||(t[14]=e("p",null,":",-1)),e("p",null,m(s.value.description),1),t[15]||(t[15]=e("p",{class:"font-semibold text-left"},"Tanggal",-1)),t[16]||(t[16]=e("p",null,":",-1)),e("p",null,m(s.value.deedDate),1),t[17]||(t[17]=e("p",{class:"font-semibold text-left"},"Status Saat Ini",-1)),t[18]||(t[18]=e("p",null,":",-1)),e("p",Se,m(a(s.value.deedStatus)),1)])])):D("",!0),y(x).isAdmin?(l(),n("div",_e,[((V=s.value)==null?void 0:V.deedStatus)===d[0]&&r.value.length<1?(l(),n("div",he," Menunggu klien mengupload dokumen ")):D("",!0),(((M=s.value)==null?void 0:M.deedStatus)===d[0]||((B=s.value)==null?void 0:B.deedStatus)===d[4])&&r.value.length>0?(l(),n("div",Ee,[(l(!0),n(_,null,h(r.value,o=>(l(),n("button",{key:o.id,class:"flex items-center gap-2 px-4 py-2 rounded border border-gray-400",disabled:""},[C(m(o.docType)+" ",1),o.status==="APPROVED"?(l(),k(R(y(ae)),{key:0,class:"text-green-900"})):o.status==="REJECTED"?(l(),k(R(y(le)),{key:1,class:"text-red-800"})):(l(),k(R(y(ne)),{key:2}))]))),128)),X(ge,{deed:s.value,onSaved:S},null,8,["deed"])])):(F=s.value)!=null&&F.number&&((J=s.value)==null?void 0:J.deedStatus)===d[1]?(l(),n("div",Ce,[e("div",Te,[(l(),n(_,null,h(d,o=>e("button",{key:o,onClick:t[0]||(t[0]=A=>U(d[2])),class:P(["px-4 py-2 rounded",s.value.deedStatus===o?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"]),disabled:""},m(a(o)),3)),64))]),t[19]||(t[19]=e("h3",null,"Proses Tanda tangan",-1)),$(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=o=>c.value=o),placeholder:"Catatan perubahan status",class:"w-full border p-1 mb-2 rounded"},null,512),[[N,c.value]]),e("button",{onClick:O,class:"bg-green-600 text-white px-4 py-2 rounded"}," Proses Tanda Tangan ")])):(L=s.value)!=null&&L.number&&((j=s.value)==null?void 0:j.deedStatus)===d[2]?(l(),n("div",Ae,[e("div",Re,[(l(),n(_,null,h(d,o=>e("button",{key:o,onClick:t[2]||(t[2]=A=>U(d[3])),class:P(["px-4 py-2 rounded",s.value.deedStatus===o?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"]),disabled:""},m(a(o)),3)),64))]),t[20]||(t[20]=e("h3",null,"Selesaikan Proses Akta",-1)),$(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>c.value=o),placeholder:"Catatan perubahan status",class:"w-full border p-1 mb-2 rounded"},null,512),[[N,c.value]]),e("button",{onClick:O,class:"bg-green-600 text-white px-4 py-2 rounded"}," Simpan ")])):(H=s.value)!=null&&H.number&&((q=s.value)==null?void 0:q.deedStatus)===d[3]?(l(),n("div",$e," Akta sudah selesai ")):(l(),k(de,{key:5,deed:s.value,onSaved:b},null,8,["deed"]))])):(l(),k(be,{key:2,documents:(Z=s.value)==null?void 0:Z.deedDocs},null,8,["documents"]))]),e("div",Ne,[t[22]||(t[22]=e("h3",{class:"text-xl font-medium mb-2"},"Riwayat Status",-1)),e("ol",Pe,[(l(!0),n(_,null,h((z=s.value)==null?void 0:z.statusHistories,(o,A)=>(l(),n("li",{key:A,class:"ms-6 pb-4"},[t[21]||(t[21]=e("span",{class:"absolute flex items-center justify-center w-6 h-6 bg-blue-100 rounded-full -start-3 ring-8 ring-white dark:ring-gray-900 dark:bg-blue-900"},[e("svg",{class:"w-2.5 h-2.5 text-blue-800 dark:text-blue-300","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})])],-1)),e("h3",Ue,m(a(o.status)),1),e("time",Oe,m(new Date(o.updatedAt).toLocaleString()),1),e("p",Ie,m(o.note),1)]))),128))])])])])}}});export{Me as default};
