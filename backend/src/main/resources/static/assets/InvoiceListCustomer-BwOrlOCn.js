import{_ as h,r as p,c as u,o as r,a as e,j as g,t as d,D as $,E as M,h as A,e as k,s as R,v as E,F as _,k as B,n as P,d as T,b as U,z as j}from"./index-TAcQkgWd.js";const F={class:"mb-4"},H={class:"mb-4"},J={class:"pt-4 mb-4 border-t"},z={__name:"CashPaymentReceipt",props:{invoice:{type:Object,required:!0}},setup(i){const c=p(null),v=()=>{const s=c.value.innerHTML,t=window.open("","","width=800,height=600");t.document.write(`
    <html>
      <head>
        <title>Cetak Tanda Terima</title>
        <style>
          body { font-family: sans-serif; padding: 20px; }
          .text-center { text-align: center; }
          .border-t { border-top: 1px solid #ccc; margin-top: 20px; padding-top: 10px; }
          @media print {
            .no-print {
              display: none !important;
            }
          }
        </style>
      </head>
      <body>${s}</body>
    </html>
  `),t.document.close(),t.focus(),t.print(),t.close()},y=s=>$(new Date(s),"dd MMMM yyyy",{locale:void 0}),b=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s);return(s,t)=>(r(),u("div",{ref_key:"printArea",ref:c,class:"max-w-xl p-8 mx-auto text-black bg-white shadow"},[t[6]||(t[6]=e("div",{class:"mb-6 text-center"},[e("h1",{class:"text-2xl font-bold"},"TANDA TERIMA PEMBAYARAN TUNAI"),e("p",{class:"text-gray-700"},"Harap dibawa saat melakukan pembayaran di kantor")],-1)),e("div",F,[e("p",null,[t[0]||(t[0]=e("strong",null,"Nomor Invoice:",-1)),g(" "+d(i.invoice.invoiceNumber),1)]),e("p",null,[t[1]||(t[1]=e("strong",null,"Tanggal Invoice:",-1)),g(" "+d(y(i.invoice.invoiceDate)),1)]),e("p",null,[t[2]||(t[2]=e("strong",null,"Jatuh Tempo:",-1)),g(" "+d(y(i.invoice.dueDate)),1)])]),e("div",H,[e("p",null,[t[3]||(t[3]=e("strong",null,"Nama Klien:",-1)),g(" "+d(i.invoice.customer.fullname),1)]),e("p",null,[t[4]||(t[4]=e("strong",null,"Transaksi:",-1)),g(" "+d(i.invoice.description),1)])]),e("div",J,[e("p",null,[t[5]||(t[5]=e("strong",null,"Total yang harus dibayar:",-1)),g(" Rp "+d(b(i.invoice.totalAmount)),1)])]),t[7]||(t[7]=e("div",{class:"p-4 text-sm text-gray-700 bg-gray-100 rounded"},[e("p",null,[e("strong",null,"Silakan lakukan pembayaran tunai ke alamat berikut:")]),e("p",null,"Kantor Notaris ABC"),e("p",null,"Jl. Mawar No. 123, BSD City, Tangerang Selatan"),e("p",null,"Jam Operasional: Senin - Jumat, 09.00 - 17.00 WIB"),e("p",null,"Telp: 021-12345678")],-1)),e("div",{class:"mt-8 text-center"},[e("button",{onClick:v,class:"btn-primary no-print"},"Cetak Tanda Terima")])],512))}},K=h(z,[["__scopeId","data-v-6061642d"]]),L={class:"p-4 space-y-2 text-sm border border-yellow-300 rounded bg-yellow-50"},V={class:"mt-4 max-h-[200px] overflow-y-auto border-t pt-3"},O={__name:"PaymentCash",props:{invoice:{type:Object,required:!0}},setup(i){return(c,v)=>(r(),u("div",L,[v[0]||(v[0]=M('<h3 class="text-base font-semibold text-yellow-800" data-v-69128541>Pembayaran Tunai</h3><p data-v-69128541>Silakan lakukan pembayaran tunai ke kantor berikut:</p><ul class="space-y-1 text-gray-700" data-v-69128541><li data-v-69128541><strong data-v-69128541>Nama Kantor:</strong> Notaris ABC</li><li data-v-69128541><strong data-v-69128541>Alamat:</strong> Jl. Mawar No. 123, BSD City, Tangsel</li><li data-v-69128541><strong data-v-69128541>Jam:</strong> Senin - Jumat, 09.00 - 17.00 WIB</li><li data-v-69128541><strong data-v-69128541>Telp:</strong> (021) 12345678</li></ul>',3)),e("div",V,[A(K,{invoice:i.invoice},null,8,["invoice"])])]))}},q=h(O,[["__scopeId","data-v-69128541"]]),W={class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"},G={class:"relative w-full max-w-md p-6 bg-white rounded"},Y={class:"mt-4"},Q={key:0,class:"mt-4"},X={class:"space-y-2"},Z=["onClick"],ee=["src"],te={class:"font-semibold"},ae={class:"text-sm text-gray-600"},ne={class:"mt-4"},se={key:1,class:"mt-4"},oe={__name:"InvoicePaymentModal",props:{invoice:Object},emits:["close","paid"],setup(i,{emit:c}){const v=i,y=c,b=p("http://localhost:8080"),s=p(""),t=p(""),f=p(null),I=[{code:"BCA",name:"Bank BCA",accountNumber:"1234567890",logo:b.value+"/images/bca-logo.png"},{code:"MANDIRI",name:"Bank Mandiri",accountNumber:"9876543210",logo:b.value+"/images/bank-mandiri-logo.png"},{code:"BSI",name:"Bank Syariah Indonesia (BSI)",accountNumber:"5566778899",logo:b.value+"/images/bsi-logo.png"}],x=()=>y("close"),w=m=>{f.value=m.target.files[0]},C=async()=>{if(!s.value){alert("Harap pilih metode pembayaran.");return}const m=new FormData;if(m.append("paymentMethod",s.value),s.value==="BANK_TRANSFER"){if(!t.value||!f.value){alert("Harap pilih bank dan upload bukti transfer.");return}m.append("bankCode",t.value),m.append("proof",f.value)}else s.value;try{console.log("Payload yang dikirim (FormData):",Object.fromEntries(m.entries())),await T.post(`/invoices/${v.invoice.id}/pay`,m,{headers:{"Content-Type":"multipart/form-data"}}),alert("Pembayaran berhasil dikirim."),y("paid"),x()}catch(o){console.error("Error saat mengirim pembayaran:",o.response?o.response.data:o.message),alert("Gagal melakukan pembayaran. Silakan coba lagi.")}},N=m=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(m);return(m,o)=>(r(),u("div",W,[e("div",G,[o[5]||(o[5]=e("h2",{class:"mb-4 text-xl font-bold"},"Pembayaran Invoice",-1)),e("p",null,"No: "+d(i.invoice.invoiceNumber),1),e("p",null,"Total: "+d(N(i.invoice.totalAmount)),1),e("div",Y,[o[2]||(o[2]=e("label",{class:"block mb-1 font-medium"},"Metode Pembayaran:",-1)),R(e("select",{"onUpdate:modelValue":o[0]||(o[0]=a=>s.value=a),class:"input"},o[1]||(o[1]=[e("option",{disabled:"",value:""},"-- Pilih --",-1),e("option",{value:"CASH"},"Cash",-1),e("option",{value:"BANK_TRANSFER"},"Transfer Bank",-1)]),512),[[E,s.value]])]),s.value==="BANK_TRANSFER"?(r(),u("div",Q,[o[4]||(o[4]=e("label",{class:"block mb-1 font-medium"},"Pilih Bank Tujuan:",-1)),e("div",X,[(r(),u(_,null,B(I,a=>e("div",{key:a.code,class:P(["flex items-center p-2 border rounded cursor-pointer hover:bg-gray-100",{"ring-2 ring-blue-500":t.value===a.code}]),onClick:n=>t.value=a.code},[e("img",{src:a.logo,alt:"logo bank",class:"w-10 h-10 mr-4"},null,8,ee),e("div",null,[e("p",te,d(a.name),1),e("p",ae,"No Rek: "+d(a.accountNumber),1)])],10,Z)),64))]),e("div",ne,[o[3]||(o[3]=e("label",{class:"block mb-1 font-medium"},"Upload Bukti Transfer:",-1)),e("input",{type:"file",onChange:w,class:"input"},null,32)])])):k("",!0),s.value==="CASH"?(r(),u("div",se,[A(q,{invoice:i.invoice},null,8,["invoice"])])):k("",!0),e("div",{class:"flex justify-end gap-2 mt-6"},[e("button",{onClick:x,class:"btn-secondary"},"Batal"),e("button",{onClick:C,class:"btn-primary"},"Bayar")]),e("button",{onClick:x,class:"absolute text-gray-500 top-2 right-2 hover:text-black"},"✕")])]))}},le=h(oe,[["__scopeId","data-v-4df83cc4"]]),ie={key:0,class:"py-4 text-center"},re={key:0,class:"p-4 text-gray-500 bg-white border border-gray-100 rounded-md"},de={class:"mb-2"},ue={style:{display:"flex","align-items":"baseline"}},ce={style:{display:"flex","align-items":"baseline"}},me={style:{display:"flex","align-items":"baseline"}},pe={style:{display:"flex","align-items":"baseline"}},ve=["onClick"],ye={key:2,class:"text-sm font-semibold text-green-600"},be={class:"flex justify-between mt-6"},ge=["disabled"],fe=["disabled"],S=4,xe={__name:"InvoiceListCustomer",setup(i){const c=p({content:[],empty:!0}),v=p(!0),y=p(0),b=p(!1),s=p(!1),t=p(null),f=async()=>{try{v.value=!0,console.log(" page "+y.value+" size "+S+" lastpage "+b);const a=await T.get(`/invoices/my-invoice?page=${y.value}&size=${S}`);c.value=a.data,b.value=a.data.last,s.value=a.data.first,c.value.empty=!a.data.content||a.data.content.length===0}catch(a){console.error("Error fetching invoices:",a)}finally{v.value=!1}},I=()=>{y.value++,fetchData()},x=()=>{y.value--,fetchData()},w=()=>{const a=t.value.id,n=c.value.content.findIndex(l=>l.id===a);n!==-1&&(c.value.content[n].paymentStatus="ISSUED"),t.value=null};U(f);const C=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a),N={ISSUED:"Masih Draft",UNPAID:"Belum Dibayar",PAID:"Sudah Dibayar",CANCELLED:"Dibatalkan"},m=a=>N[a]||a,o=a=>{switch(a){case"PAID":return"px-2 py-1 ml-1 font-semibold text-white bg-green-700 rounded-sm";case"ISSUED":return"px-2 py-1 ml-1 font-semibold text-white bg-yellow-600 rounded-sm";case"UNPAID":return"px-2 py-1 ml-1 font-semibold text-white bg-red-600 rounded-sm";default:return"px-2 py-1 ml-1 font-semibold text-white bg-gray-500 rounded-sm"}};return(a,n)=>(r(),u("div",null,[n[8]||(n[8]=e("h1",{class:"mb-4 text-2xl font-bold text-center md:text-left"},"Daftar Invoice",-1)),v.value?(r(),u("div",ie,n[3]||(n[3]=[e("span",{class:"inline-block w-6 h-6 border-4 border-blue-400 rounded-full animate-spin border-t-transparent"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500"},"Memuat data ...",-1)]))):k("",!0),(r(!0),u(_,null,B(c.value.content,l=>{var D;return r(),u("div",{key:l.id,class:"flex flex-col justify-between gap-2 p-4 mb-4 bg-white border border-gray-300 rounded shadow sm:flex-row sm:items-center"},[(D=c.value)!=null&&D.empty?(r(),u("div",re,"Tidak ada invoice.")):k("",!0),e("div",de,[e("div",ue,[n[4]||(n[4]=e("strong",{style:{width:"100px"}},"No. Invoice",-1)),e("span",null,": "+d(l.invoiceNumber),1)]),e("div",ce,[n[5]||(n[5]=e("strong",{style:{width:"100px"}},"Tanggal",-1)),e("span",null,": "+d(l.invoiceDate),1)]),e("div",me,[n[6]||(n[6]=e("strong",{style:{width:"100px"}},"Total",-1)),e("span",null,": "+d(C(l==null?void 0:l.totalAmount)),1)]),e("div",pe,[n[7]||(n[7]=e("strong",{style:{width:"100px"}},"Status",-1)),e("span",{class:P(o(l.status||"UNPAID"))},d(m(l.status||"UNPAID")),3)])]),l.status!=="PAID"?(r(),u("button",{key:1,onClick:ke=>t.value=l,class:"btn-primary"},"Pilih Metode Bayar",8,ve)):(r(),u("span",ye,"Sudah Dibayar"))])}),128)),e("div",be,[e("button",{disabled:s.value,onClick:n[0]||(n[0]=l=>x()),class:"text-blue-600 hover:underline disabled:text-gray-400"}," ← Sebelumnya ",8,ge),e("button",{disabled:b.value,onClick:n[1]||(n[1]=l=>I()),class:"text-blue-600 hover:underline disabled:text-gray-400"}," Selanjutnya → ",8,fe)]),t.value?(r(),j(le,{key:1,invoice:t.value,onClose:n[2]||(n[2]=l=>t.value=null),onPaid:w},null,8,["invoice"])):k("",!0)]))}},Ie=h(xe,[["__scopeId","data-v-a643085e"]]);export{Ie as default};
