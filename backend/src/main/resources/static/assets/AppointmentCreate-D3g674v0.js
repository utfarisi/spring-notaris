import{r as p,y as w,l as x,c as i,a as t,s as u,v as b,x as v,F as g,k as c,d as f,o,t as y,n as j}from"./index-BHdmYk1o.js";const h={class:"space-y-3 bg-white rounded-md shadow p-6"},T={class:"p-2 mt-5"},D={class:"p-2"},M={class:"p-2"},S=["value"],_={class:"p-2"},J={key:0,class:"border border-gray-300 text-center py-4"},C={key:1,class:"text-sm text-red-500"},V={key:2,class:"grid grid-cols-3 gap-2"},B=["onClick"],U={class:"p-2"},A={class:"text-right mt-6"},W=["disabled"],N={__name:"AppointmentCreate",setup(F){const s=p([]),d=p(!1),l=w().user;console.log(" user id ",l==null?void 0:l.id);const n=p({userId:l==null?void 0:l.id,appointmentDate:"",appointmentTime:"",durationMinute:30,description:""});x([()=>n.value.appointmentDate,()=>n.value.durationMinute],async([r,e])=>{if(n.value.appointmentTime="",!(!r||!e)){d.value=!0;try{const a=await f.get("/appointments/available-times",{params:{date:r,duration:e}});s.value=a.data.map(m=>m.substring(0,5))}catch(a){console.error("Gagal mengambil waktu janji",a),s.value=[]}finally{d.value=!1}}});const k=async()=>{var r;if(!n.value.appointmentDate||!n.value.appointmentTime){alert("Harap pilih tanggal dan waktu janji.");return}try{console.log(" id ",l==null?void 0:l.id),await f.post("/appointments",n.value),alert("Janji berhasil disimpan!"),n.value={userId:l.id,appointmentDate:"",appointmentTime:"",description:"",durationMinute:30},s.value=[]}catch(e){((r=e.response)==null?void 0:r.status)===409?alert("Waktu yang dipilih sudah terisi. Silakan pilih waktu lain."):(alert("Gagal menyimpan janji. Coba lagi nanti."),console.error(e))}};return(r,e)=>(o(),i("div",null,[e[12]||(e[12]=t("h2",{class:"text-xl font-bold mb-4"},"Buat Janji dengan Notaris",-1)),t("div",h,[t("div",T,[e[5]||(e[5]=t("label",{class:"block font-medium"},"Durasi Janji (menit)",-1)),u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.durationMinute=a),class:"border border-gray-300 rounded-lg form-select w-full p-2"},e[4]||(e[4]=[t("option",{value:30},"30 menit",-1),t("option",{value:60},"1 jam",-1),t("option",{value:90},"1.5 jam",-1)]),512),[[b,n.value.durationMinute]])]),t("div",D,[e[6]||(e[6]=t("label",{class:"block font-medium"},"Tanggal Janji",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.appointmentDate=a),type:"date",class:"border border-gray-300 rounded-lg form-select w-full p-2 form-input w-full"},null,512),[[v,n.value.appointmentDate]])]),t("div",M,[e[8]||(e[8]=t("label",{class:"block font-medium"},"Waktu Janji",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.appointmentTime=a),class:"border border-gray-300 rounded-lg form-select w-full p-2 form-input w-full"},[e[7]||(e[7]=t("option",{disabled:"",value:""},"Pilih waktu",-1)),(o(!0),i(g,null,c(s.value,a=>(o(),i("option",{key:a,value:a},y(a),9,S))),128))],512),[[b,n.value.appointmentTime]])]),t("div",_,[e[10]||(e[10]=t("label",{class:"block font-medium mb-1"},"Pilih Waktu Janji",-1)),d.value?(o(),i("div",J,e[9]||(e[9]=[t("span",{class:"animate-spin rounded-full h-6 w-6 border-4 border-blue-400 border-t-transparent inline-block"},null,-1),t("p",{class:"text-sm text-gray-500 mt-2"},"Memuat waktu tersedia...",-1)]))):s.value.length===0?(o(),i("div",C," Semua waktu janji pada tanggal ini sudah terisi. ")):(o(),i("div",V,[(o(!0),i(g,null,c(s.value,a=>(o(),i("button",{key:a,type:"button",onClick:m=>n.value.appointmentTime=a,class:j(["px-4 py-2 rounded border",n.value.appointmentTime===a?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-800 border-gray-300 hover:bg-blue-100"])},y(a),11,B))),128))]))]),t("div",U,[e[11]||(e[11]=t("label",{class:"block font-medium"},"Keterangan",-1)),u(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>n.value.description=a),class:"form-textarea w-full border border-gray-300",rows:"3"},null,512),[[v,n.value.description]])]),t("div",A,[t("button",{type:"button",onClick:k,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",disabled:!n.value.appointmentDate||!n.value.appointmentTime}," Simpan Janji ",8,W)])])]))}};export{N as default};
